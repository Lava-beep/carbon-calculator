<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoLeaf Analytics | AI-Powered Carbon Accounting</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🌱</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00b894;
            --secondary: #00897b;
            --text: #333;
            --light-text: #555;
            --bg: #fdfdfd;
            --light-bg: #f1f8f7;
            --white: #ffffff;
            --border-color: #e0e0e0;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
        }
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 4rem 2rem;
            text-align: center;
        }
        h1, h2, h3 { color: var(--secondary); font-weight: 700; }
        h1 { font-size: 3rem; }
        h2 { font-size: 2.2rem; margin-bottom: 1rem; }
        p { color: var(--light-text); margin-bottom: 1rem; max-width: 650px; margin-left: auto; margin-right: auto; }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .nav-logo { font-size: 1.5rem; font-weight: 700; color: var(--primary); }
        .nav-links a {
            margin: 0 1rem;
            text-decoration: none;
            color: var(--text);
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--primary); }
        .cta-btn {
            padding: 0.7rem 1.8rem;
            background: var(--primary);
            color: var(--white);
            border: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: background 0.3s, transform 0.1s, box-shadow 0.1s;
            box-shadow: 0 4px 15px rgba(0, 184, 148, 0.2);
        }
        .cta-btn:hover { background: var(--secondary); }
        .cta-btn:active { transform: translateY(2px); box-shadow: 0 2px 5px rgba(0, 184, 148, 0.2);}
        .hero {
            background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1504868584819-f8e8b4b6d7e3?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1600&h=900&fit=crop');
            background-size: cover;
            background-position: center;
            color: var(--white);
            min-height: 85vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .hero .container { padding: 0 2rem; }
        .hero h1 {
            color: var(--white);
            font-size: 3.5rem;
            animation: fadeInDown 1s ease-out;
        }
        .hero p {
            color: rgba(255,255,255,0.9);
            font-size: 1.2rem;
            margin-top: 1rem;
            margin-bottom: 2rem;
            animation: fadeInUp 1s ease-out 0.5s;
            animation-fill-mode: both;
        }
        .hero .cta-btn {
            font-size: 1.1rem;
            padding: 0.9rem 2.5rem;
            animation: fadeInUp 1s ease-out 1s;
            animation-fill-mode: both;
        }
        .how-it-works { background: var(--light-bg); }
        .how-it-works-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }
        .step-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.04);
        }
        .step-card .icon {
            font-size: 2.5rem;
            color: var(--primary);
            background: var(--light-bg);
            width: 70px;
            height: 70px;
            line-height: 70px;
            border-radius: 50%;
            margin: 0 auto 1.5rem;
        }
        .step-card h3 { margin-bottom: 0.5rem; font-size: 1.3rem; }
        .stats {
            background: var(--secondary);
            color: var(--white);
        }
        .stats h2, .stats p { color: var(--white); }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }
        .stat-item .stat-number { font-size: 3rem; font-weight: 700; }
        .stat-item .stat-label { font-size: 1rem; color: rgba(255,255,255,0.8); }
        .testimonials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
            text-align: left;
        }
        .testimonial-card {
            background: var(--light-bg);
            padding: 2rem;
            border-radius: 12px;
            border-left: 5px solid var(--primary);
        }
        .testimonial-card p { font-style: italic; margin-bottom: 1.5rem; }
        .testimonial-author { display: flex; align-items: center; }
        .testimonial-author img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 1rem;
            object-fit: cover;
        }
        .author-info h4 { color: var(--secondary); }
        .author-info span { font-size: 0.9rem; color: var(--light-text); }
        .faq { background: var(--light-bg); }
        .faq-item {
            background: var(--white);
            margin-bottom: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            text-align: left;
        }
        .faq-question {
            width: 100%;
            background: none;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            color: var(--secondary);
        }
        .faq-question::after {
            content: '+';
            font-size: 1.5rem;
            transition: transform 0.3s;
        }
        .faq-item.active .faq-question::after { transform: rotate(45deg); }
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out, padding 0.3s;
            padding: 0 1.5rem;
        }
        .faq-item.active .faq-answer {
            max-height: 200px;
            padding: 0 1.5rem 1.5rem;
        }
        .footer {
            background: #2d3436;
            color: #bdc3c7;
            padding: 3rem 2rem;
        }
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            text-align: left;
        }
        .footer-col h4 { color: var(--white); margin-bottom: 1rem; }
        .footer-col ul { list-style: none; }
        .footer-col li { margin-bottom: 0.5rem; }
        .footer-col a { color: #bdc3c7; text-decoration: none; transition: color 0.3s; }
        .footer-col a:hover { color: var(--primary); }
        .footer-bottom {
            text-align: center;
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid #3d4446;
            font-size: 0.9rem;
        }
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); }
        }
        .reveal {
            position: relative;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.8s, transform 0.8s;
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: rgba(20,32,40,0.55);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(3px);
            animation: modalFadeIn 0.25s ease;
        }
        .modal-overlay.active { display: flex; }
        @keyframes modalFadeIn {
            from { opacity:0 }
            to { opacity:1 }
        }
        .modal-demoform {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.18);
            max-width: 410px;
            width: 92vw;
            padding: 2.2rem 1.7rem 1.5rem 1.7rem;
            position: relative;
            animation: modalPopIn 0.3s cubic-bezier(.21,1.09,.49,.98);
        }
        @keyframes modalPopIn {
            from { transform: scale(0.87); opacity:0.4 }
            to { transform: scale(1); opacity:1 }
        }
        .modal-demoform h2 {
            color: var(--primary);
            font-size: 1.5rem;
            margin-bottom: 1.2rem;
        }
        .modal-demoform label {
            text-align: left;
            display: block;
            color: var(--secondary);
            margin-bottom: 0.12rem;
            font-size: 1rem;
            font-weight: 600;
        }
        .modal-demoform input,
        .modal-demoform textarea {
            width: 100%;
            margin-bottom: 1.2rem;
            border-radius: 8px;
            border: 1px solid #d7fbe5;
            padding: 0.8rem 0.7rem;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            resize: none;
            background: #f7faf9;
            box-sizing: border-box;
        }
        .modal-demoform textarea { height: 80px;}
        .modal-demoform .cta-btn { width: 100%; margin-top: 0.5rem; font-size: 1.05rem; }
        .modal-close {
            position: absolute;
            right: 16px;
            top: 14px;
            background: none;
            border: none;
            font-size: 1.65rem;
            color: #aaa;
            cursor: pointer;
            transition: color 0.2s;
        }
        .modal-close:hover { color: var(--primary);}
        .modal-success-message {
            display: none;
            text-align: center;
            color: var(--primary);
            font-size: 1.13rem;
            padding: 1.1rem 0 0 0;
        }
        .modal-success-message.active { display: block;}
        @media (max-width: 600px){
            .modal-demoform{padding:1.2rem 0.4rem;}
        }
        #carbon-calculator label { display: block; font-weight: 600; color: var(--secondary); margin-bottom: 0.3rem; }
        #carbon-calculator input { width: 100%; padding: 0.6rem 0.8rem; margin-bottom: 1rem; border: 1px solid #c7f0d2; border-radius: 6px; font-size: 1rem; }
        #carbon-calculator button.cta-btn { width: 100%; }
        
        /* Enhanced Calculator Styles */
        .calculator-container { background: var(--white); border-radius: 16px; padding: 2rem; box-shadow: 0 8px 32px rgba(0,0,0,0.08); }
        .enhanced-form { display: flex; flex-direction: column; gap: 2rem; }
        .form-section { background: var(--light-bg); padding: 1.5rem; border-radius: 12px; }
        .form-section h3 { color: var(--secondary); margin-bottom: 1rem; font-size: 1.2rem; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-weight: 600; color: var(--secondary); margin-bottom: 0.5rem; font-size: 0.95rem; }
        .form-group input, .form-group select { padding: 0.75rem; border: 2px solid #e1f5fe; border-radius: 8px; font-size: 1rem; transition: border-color 0.3s; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--primary); }
        .input-help { font-size: 0.8rem; color: var(--light-text); margin-top: 0.25rem; }
        .form-group input[type="range"] { margin: 0.5rem 0; }
        .range-value { font-weight: 600; color: var(--primary); }
        .form-group input[type="checkbox"] { width: auto; margin-right: 0.5rem; }
        .form-actions { display: flex; gap: 1rem; justify-content: center; margin-top: 1rem; }
        .enhanced-btn { background: linear-gradient(135deg, var(--primary), var(--secondary)); }
        .secondary-btn { background: #f8f9fa; color: var(--secondary); border: 2px solid var(--primary); }
        .secondary-btn:hover { background: var(--light-bg); }
        .clear-btn { background: #fff3cd; color: #856404; border: 2px solid #ffc107; }
        .clear-btn:hover { background: #fff8e1; transform: translateY(-2px); }
        
        /* Results Dashboard Styles */
        .results-container { background: var(--white); border-radius: 16px; padding: 2rem; box-shadow: 0 8px 32px rgba(0,0,0,0.08); margin-top: 2rem; }
        .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .results-header h3 { color: var(--secondary); margin: 0; }
        .confidence-indicator { display: flex; align-items: center; gap: 0.5rem; }
        .confidence-value { background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-weight: 600; }
        
        /* Metrics Grid */
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
        .metric-card { background: linear-gradient(135deg, #f8fffe, #e8f8f5); border: 1px solid #d4f1e8; border-radius: 12px; padding: 1.5rem; text-align: center; }
        .metric-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        .metric-value { font-size: 2rem; font-weight: 700; color: var(--primary); margin-bottom: 0.25rem; }
        .metric-label { font-size: 0.9rem; color: var(--light-text); }
        
        /* Visualizations */
        .viz-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 2rem; }
        .chart-container { background: var(--light-bg); border-radius: 12px; padding: 1rem; height: 300px; }
        
        /* Recommendations */
        .recommendations-section, .predictions-section, .action-plan-section { margin-bottom: 2rem; }
        .recommendations-section h4, .predictions-section h4, .action-plan-section h4 { color: var(--secondary); margin-bottom: 1rem; }
        .recommendations-list { display: flex; flex-direction: column; gap: 0.75rem; }
        .recommendation-item { background: var(--light-bg); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary); }
        .recommendation-priority { display: inline-block; background: var(--primary); color: white; padding: 0.2rem 0.5rem; border-radius: 12px; font-size: 0.8rem; margin-bottom: 0.5rem; }
        
        /* Predictions Grid */
        .predictions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        .prediction-card { background: var(--light-bg); padding: 1.5rem; border-radius: 12px; text-align: center; }
        .prediction-card h5 { color: var(--secondary); margin-bottom: 0.75rem; font-size: 1rem; }
        .prediction-value { font-size: 1.5rem; font-weight: 600; color: var(--primary); }
        
        /* Action Timeline */
        .action-timeline { display: flex; flex-direction: column; gap: 1rem; }
        .action-item { display: flex; align-items: center; background: var(--light-bg); padding: 1rem; border-radius: 8px; }
        .action-timeline-dot { width: 12px; height: 12px; background: var(--primary); border-radius: 50%; margin-right: 1rem; }
        .action-content { flex: 1; }
        .action-title { font-weight: 600; color: var(--secondary); }
        .action-timeline-text { color: var(--light-text); font-size: 0.9rem; }
        
        /* Loading States */
        .loading { opacity: 0.6; pointer-events: none; }
        .spinner { border: 3px solid #f3f3f3; border-top: 3px solid var(--primary); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; }
            .hero h1 { font-size: 2.8rem; }
            .nav-links { display: none; }
        }
        /* Chatbot styles */
        #ecoChatbot-widget {
            position: fixed;
            bottom: 26px; right: 26px;
            z-index: 2100;
            font-family: 'Inter', sans-serif;
        }
        #ecoChatbot-toggle {
            background: var(--primary);
            color: #fff;
            width: 62px; height: 62px;
            border-radius: 50%;
            border: none;
            box-shadow: 0 3px 24px rgba(0, 184, 148, .28);
            font-size: 2.1rem;
            cursor: pointer;
            display: flex;
            align-items: center; justify-content: center;
            transition: box-shadow 0.18s, background 0.18s;
            outline: none;
        }
        #ecoChatbot-toggle:active { background: var(--secondary);}
        #ecoChatbot-body {
            background: #fff;
            width: 340px; max-width: 94vw;
            height: 430px;
            max-height: 85vh;
            box-shadow: 0 8px 34px rgba(0,0,0,0.17);
            border-radius: 20px;
            position: absolute;
            bottom: 80px; right: 0;
            display: flex;
            flex-direction: column;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.24s, transform 0.24s;
            transform:scale(0.97) translateY(35px);
        }
        #ecoChatbot-widget.open #ecoChatbot-body {
            opacity: 1;
            pointer-events: all;
            transform: scale(1) translateY(0);
        }
        #ecoChatbot-header {
            background: var(--primary);
            border-radius: 20px 20px 0 0;
            padding: 1.06rem 1.1rem 0.85rem 1.1rem;
            display: flex;
            align-items: center;
        }
        #ecoChatbot-avatar {
            background: #fff;
            color: var(--primary);
            font-size: 1.35rem;
            border-radius: 50%;
            width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            margin-right: 0.78rem;
            border: 2px solid var(--accent,#fff);
        }
        #ecoChatbot-title {
            color: var(--white); font-weight: 700; font-size: 1.09rem;
        }
        #ecoChatbot-close {
            margin-left: auto;
            background: none; border: none; color: #fff; font-size: 1.35rem;
            cursor: pointer;
            transition: color 0.25s;
        }
        #ecoChatbot-close:hover { color: #91f1c3;}
        #ecoChatbot-messages {
            flex: 1; overflow-y:auto; padding: 1.02rem; background: #fafdfe;
            font-size: 1.003rem;
            display: flex; flex-direction:column;
        }
        .ecoChatbot-msg {
            margin-bottom: 1rem; display: flex; align-items:flex-end;
        }
        .ecoChatbot-msg.user {
            flex-direction: row-reverse;
        }
        .ecoChatbot-msg .bubble {
            padding: 0.7rem 1.05rem;
            border-radius: 17px;
            box-shadow: 0 2px 8px rgba(33,191,115,0.02);
            font-size: 0.99rem;
            max-width: 81%;
        }
        .ecoChatbot-msg.bot .bubble {
            background: #f1fbf6;
            color: var(--secondary);
            border-bottom-left-radius: 2.5px;
        }
        .ecoChatbot-msg.user .bubble {
            background: var(--primary);
            color: #fff;
            border-bottom-right-radius: 2.5px;
        }
        #ecoChatbot-inputbar {
            display: flex; align-items: center;
            border-top: 1px solid #e6f8ef; padding: 0.75rem 1.05rem;
            background: #fafdfb;
            border-radius: 0 0 20px 20px;
        }
        #ecoChatbot-input {
            flex:1; border: none; font-size: 1.01rem; padding: 0.4rem 0.6rem; border-radius: 10px;
            background: #f6fcff;
            margin-right: 0.7rem;
            outline: none;
            color: var(--secondary);
        }
        #ecoChatbot-send {
            background: var(--primary);
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 39px; height: 39px;
            font-size: 1.5rem;
            cursor: pointer;
            outline: none;
            transition: background 0.18s;
        }
        #ecoChatbot-send:active { background: var(--secondary);}
        /* Bot typing effect */
        .typing { display: inline-block; }
        .dot { height: 7px; width: 7px; margin: 2px 1.5px; background: #a0e1c7; border-radius: 50%; display: inline-block; animation: blink .95s infinite alternate; }
        .dot:nth-child(2){ animation-delay: 0.18s;}
        .dot:nth-child(3){ animation-delay: 0.36s;}
        @keyframes blink { 0%{opacity: .5;} 100%{opacity:1;} }
        @media (max-width: 425px) {
            #ecoChatbot-header{padding:0.7rem 0.7rem;}
            #ecoChatbot-messages{ font-size: 0.96rem; padding: 0.7rem;}
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-logo">EcoLeaf Analytics</div>
        <div class="nav-links">
            <a href="#how-it-works">How It Works</a>
            <a href="#stats">Impact</a>
            <a href="#testimonials">Clients</a>
            <a href="#faq">FAQ</a>
        </div>
        <button class="cta-btn" id="requestDemoBtn">Request a Demo</button>
    </nav>
    <header class="hero">
        <div class="container">
            <h1>AI-Powered Carbon Accounting. <br>Simplified.</h1>
            <p>Go beyond compliance. Turn sustainability into your competitive advantage with the most intuitive and powerful carbon management platform.</p>
            <button class="cta-btn" onclick="window.location='#how-it-works'">Learn How</button>
        </div>
    </header>
    <main>
        <section id="how-it-works" class="how-it-works container reveal">
            <h2>Your Path to Net-Zero in 3 Simple Steps</h2>
            <p>Our platform streamlines every aspect of carbon accounting, from data collection to decarbonization planning.</p>
            <div class="how-it-works-grid">
                <div class="step-card">
                    <div class="icon">🔗</div>
                    <h3>1. Connect Your Data</h3>
                    <p>Securely integrate data from your ERP, accounting software, and utility providers. Our AI automates the entire process.</p>
                </div>
                <div class="step-card">
                    <div class="icon">🧠</div>
                    <h3>2. Get AI-Powered Insights</h3>
                    <p>Our algorithms analyze your data, identify emission hotspots, and provide a complete, audit-ready carbon footprint.</p>
                </div>
                <div class="step-card">
                    <div class="icon">📈</div>
                    <h3>3. Reduce & Report</h3>
                    <p>Use our tools to model reduction scenarios, set science-based targets, and generate compliant reports with a single click.</p>
                </div>
            </div>
        </section>
        <section id="stats" class="stats container reveal">
            <h2>Driving Real-World Impact</h2>
            <p>We empower businesses to achieve measurable sustainability goals.</p>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" data-target="40">0</div>
                    <div class="stat-label">Average Emissions Reduction (%)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" data-target="95">0</div>
                    <div class="stat-label">Data Accuracy Rate (%)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" data-target="500">0</div>
                    <div class="stat-label">Companies Empowered</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" data-target="12">0</div>
                    <div class="stat-label">Million Tons of CO2e Tracked</div>
                </div>
            </div>
        </section>
        <section id="testimonials" class="container reveal">
            <h2>Trusted by Industry Leaders</h2>
            <p>See what our clients have to say about their journey with EcoLeaf Analytics.</p>
            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <p>"EcoLeaf transformed our approach to sustainability. What used to take months of manual work now takes hours, and the insights are invaluable."</p>
                    <div class="testimonial-author">
                        <img src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=100&h=100&fit=crop" alt="Author">
                        <div class="author-info">
                            <h4>Sarah Chen</h4>
                            <span>CSO, FutureTech Inc.</span>
                        </div>
                    </div>
                </div>
                <div class="testimonial-card">
                    <p>"The platform is incredibly user-friendly and the support team is outstanding. We finally have a clear, actionable plan to reach our net-zero goals."</p>
                    <div class="testimonial-author">
                        <img src="https://images.unsplash.com/photo-1557862921-37829c790f19?w=100&h=100&fit=crop" alt="Author">
                        <div class="author-info">
                            <h4>David Lee</h4>
                            <span>Operations Director, GreenGoods</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- AI-Powered Carbon Calculator Section -->
        <section id="carbon-calculator" class="container reveal" style="margin-bottom: 4rem;">
          <h2>🤖 AI-Powered Carbon Calculator</h2>
          <p>Advanced machine learning algorithms provide accurate calculations with industry-specific insights and predictive analytics.</p>
          
          <!-- Enhanced Calculator Form -->
          <div class="calculator-container" style="max-width: 800px; margin: 0 auto;">
            <form id="carbonCalcForm" class="enhanced-form">
              <!-- Basic Data Section -->
              <div class="form-section">
                <h3>📊 Company Data</h3>
                <div class="form-grid">
                  <div class="form-group">
                    <label for="energy">Annual Energy Consumption (kWh)</label>
                    <input type="number" id="energy" name="energy" placeholder="e.g. 150000" required min=0 />
                    <div class="input-help">💡 Include electricity, heating, and cooling</div>
                  </div>
                  <div class="form-group">
                    <label for="energySource">Primary Energy Source</label>
                    <select id="energySource" name="energySource">
                      <option value="default">Grid Average</option>
                      <option value="renewable">Renewable Energy</option>
                      <option value="coal">Coal-based</option>
                      <option value="natural_gas">Natural Gas</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="fuel">Annual Fuel Consumption (liters)</label>
                    <input type="number" id="fuel" name="fuel" placeholder="e.g. 50000" required min=0 />
                  </div>
                  <div class="form-group">
                    <label for="fuelType">Primary Fuel Type</label>
                    <select id="fuelType" name="fuelType">
                      <option value="gasoline">Gasoline</option>
                      <option value="diesel">Diesel</option>
                      <option value="natural_gas">Natural Gas</option>
                      <option value="lpg">LPG</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="employees">Number of Employees</label>
                    <input type="number" id="employees" name="employees" placeholder="e.g. 100" required min=1 />
                  </div>
                  <div class="form-group">
                    <label for="travel">Annual Business Travel (km)</label>
                    <input type="number" id="travel" name="travel" placeholder="e.g. 20000" required min=0 />
                  </div>
                  <div class="form-group">
                    <label for="waste">Annual Waste Generated (tons)</label>
                    <input type="number" step="0.01" id="waste" name="waste" placeholder="e.g. 15.5" required min=0 />
                  </div>
                  <div class="form-group">
                    <label for="industry">Industry Sector</label>
                    <select id="industry" name="industry">
                      <option value="technology">Technology</option>
                      <option value="manufacturing">Manufacturing</option>
                      <option value="retail">Retail</option>
                      <option value="finance">Finance</option>
                      <option value="healthcare">Healthcare</option>
                      <option value="automotive">Automotive</option>
                      <option value="construction">Construction</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Advanced Options -->
              <div class="form-section">
                <h3>⚙️ Advanced Options</h3>
                <div class="form-grid">
                  <div class="form-group">
                    <label for="remoteWork">Remote Work Percentage</label>
                    <input type="range" id="remoteWork" name="remoteWork" min="0" max="100" value="20" />
                    <span class="range-value">20%</span>
                  </div>
                  <div class="form-group">
                    <label for="greenInitiatives">
                      <input type="checkbox" id="greenInitiatives" name="greenInitiatives" />
                      Has Green Initiatives in Place
                    </label>
                  </div>
                  <div class="form-group">
                    <label for="companySize">Company Size</label>
                    <select id="companySize" name="companySize">
                      <option value="small">Small (1-50 employees)</option>
                      <option value="medium">Medium (51-500 employees)</option>
                      <option value="large">Large (500+ employees)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="location">Primary Location</label>
                    <select id="location" name="location">
                      <option value="US">United States</option>
                      <option value="EU">European Union</option>
                      <option value="UK">United Kingdom</option>
                      <option value="CN">China</option>
                      <option value="IN">India</option>
                      <option value="OTHER">Other</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" class="cta-btn enhanced-btn">
                  🧠 Calculate with AI Analytics
                </button>
                <button type="button" id="saveDataBtn" class="secondary-btn">
                  💾 Save Data
                </button>
                <button type="button" id="loadDataBtn" class="secondary-btn">
                  📋 Load Saved Data
                </button>
                <button type="button" id="clearDataBtn" class="clear-btn">
                  🧹 Clear Form
                </button>
              </div>
            </form>
          </div>

          <!-- Results Dashboard -->
          <div id="resultsContainer" class="results-container" style="display: none;">
            <div class="results-header">
              <h3>📈 Your Carbon Footprint Analysis</h3>
              <div class="confidence-indicator">
                <span>Confidence Score: </span>
                <span id="confidenceScore" class="confidence-value">--</span>
              </div>
            </div>

            <!-- Key Metrics -->
            <div class="metrics-grid">
              <div class="metric-card">
                <div class="metric-icon">🌍</div>
                <div class="metric-value" id="totalEmissions">--</div>
                <div class="metric-label">Total CO₂e (tons/year)</div>
              </div>
              <div class="metric-card">
                <div class="metric-icon">👥</div>
                <div class="metric-value" id="perEmployeeEmissions">--</div>
                <div class="metric-label">Per Employee (tons)</div>
              </div>
              <div class="metric-card">
                <div class="metric-icon">📊</div>
                <div class="metric-value" id="industryPercentile">--</div>
                <div class="metric-label">Industry Percentile</div>
              </div>
              <div class="metric-card">
                <div class="metric-icon">⭐</div>
                <div class="metric-value" id="efficiencyScore">--</div>
                <div class="metric-label">Efficiency Score</div>
              </div>
            </div>

            <!-- Visualizations -->
            <div class="viz-container">
              <div class="chart-container">
                <canvas id="breakdownChart"></canvas>
              </div>
              <div class="chart-container">
                <canvas id="benchmarkChart"></canvas>
              </div>
            </div>

            <!-- AI Recommendations -->
            <div class="recommendations-section">
              <h4>🎯 AI-Generated Recommendations</h4>
              <div id="aiRecommendations" class="recommendations-list"></div>
            </div>

            <!-- Predictions -->
            <div class="predictions-section">
              <h4>🔮 Predictive Analytics</h4>
              <div class="predictions-grid">
                <div class="prediction-card">
                  <h5>Next Year Projection</h5>
                  <div id="nextYearProjection" class="prediction-value">--</div>
                </div>
                <div class="prediction-card">
                  <h5>Reduction Potential</h5>
                  <div id="reductionPotential" class="prediction-value">--</div>
                </div>
                <div class="prediction-card">
                  <h5>Carbon Neutrality</h5>
                  <div id="neutralityTimeline" class="prediction-value">--</div>
                </div>
                <div class="prediction-card">
                  <h5>Cost Savings</h5>
                  <div id="costSavings" class="prediction-value">--</div>
                </div>
              </div>
            </div>

            <!-- Action Plan -->
            <div class="action-plan-section">
              <h4>📋 Recommended Action Plan</h4>
              <div id="actionPlan" class="action-timeline"></div>
            </div>
          </div>
        </section>
        <!-- END AI-Powered Carbon Calculator Section -->
        <section id="faq" class="faq container reveal">
            <h2>Frequently Asked Questions</h2>
            <div class="faq-container">
                <div class="faq-item">
                    <button class="faq-question">How does the AI improve accuracy?</button>
                    <div class="faq-answer">
                        <p>Our AI cross-references thousands of data points and uses machine learning to fill data gaps intelligently, reducing the errors common in manual calculations and ensuring your footprint is audit-proof.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">Is your platform compliant with global standards?</button>
                    <div class="faq-answer">
                        <p>Yes, we are fully compliant with the GHG Protocol, ISO 14064, and other major global reporting standards. Our reports are accepted by all major regulatory bodies.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">What kind of support do you offer?</button>
                    <div class="faq-answer">
                        <p>We offer dedicated onboarding support, access to climate experts, and a comprehensive knowledge base to ensure you get the most out of our platform from day one.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer class="footer">
        <div class="container" style="padding-top:0; padding-bottom:0;">
            <div class="footer-grid">
                <div class="footer-col">
                    <h4>EcoLeaf Analytics</h4>
                    <p style="text-align:left; max-width: 250px;">AI-Powered Carbon Accounting for a Sustainable Future.</p>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="#how-it-works">How It Works</a></li>
                        <li><a href="#stats">Impact</a></li>
                        <li><a href="#testimonials">Clients</a></li>
                        <li><a href="#faq">FAQ</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Follow Us</h4>
                    <ul>
                        <li><a href="#">LinkedIn</a></li>
                        <li><a href="#">Twitter</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                &copy; 2025 EcoLeaf Analytics. All Rights Reserved.
            </div>
        </div>
    </footer>
    <!-- Modal: Request a Demo -->
    <div class="modal-overlay" id="modalOverlay" tabindex="-1" aria-modal="true" role="dialog" aria-labelledby="modalDemoTitle">
      <form class="modal-demoform" id="modalDemoForm" autocomplete="off">
        <button type="button" class="modal-close" id="modalCloseBtn" aria-label="Close">&times;</button>
        <h2 id="modalDemoTitle">Request a Demo</h2>
        <label for="demoName">Name</label>
        <input id="demoName" name="name" type="text" placeholder="Your Name" required autocomplete="off" maxlength="80">
        <label for="demoEmail">Email</label>
        <input id="demoEmail" name="email" type="email" placeholder="you@email.com" required autocomplete="off" maxlength="120">
        <label for="demoMsg">Message</label>
        <textarea id="demoMsg" name="message" placeholder="Tell us your use case..." required maxlength="280"></textarea>
        <button class="cta-btn" type="submit">Submit Demo Request</button>
        <div class="modal-success-message" id="modalSuccessMsg">Thank you! We’ll be in touch soon.</div>
      </form>
    </div>

    <!-- AI Chatbot Assistant Widget -->
    <div id="ecoChatbot-widget">
        <button id="ecoChatbot-toggle" aria-label="Open AI Assistant"><span>💬</span></button>
        <div id="ecoChatbot-body" aria-live="polite">
            <div id="ecoChatbot-header">
                <span id="ecoChatbot-avatar">🤖</span>
                <span id="ecoChatbot-title">EcoLeaf AI Assistant</span>
                <button id="ecoChatbot-close" aria-label="Close">&times;</button>
            </div>
            <div id="ecoChatbot-messages"></div>
            <form id="ecoChatbot-inputbar" autocomplete="off">
                <input id="ecoChatbot-input" type="text" placeholder="Ask me anything..." autocomplete="off" required>
                <button type="submit" id="ecoChatbot-send" aria-label="Send">➤</button>
            </form>
        </div>
    </div>

    <script src="ai-carbon-engine.js"></script>
    <script src="intelligent-chatbot.js"></script>
    <script src="carbon-analytics.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Verify script loading
        console.log('Script loading verification:');
        console.log('- AICarbonEngine:', typeof AICarbonEngine !== 'undefined' ? '✓' : '✗');
        console.log('- IntelligentChatbot:', typeof IntelligentChatbot !== 'undefined' ? '✓' : '✗');
        console.log('- CarbonAnalyticsEngine:', typeof CarbonAnalyticsEngine !== 'undefined' ? '✓' : '✗');
        console.log('- Chart.js:', typeof Chart !== 'undefined' ? '✓' : '✗');
    </script>

    <script>
        // --- Global AI/ML Components ---
        let aiCarbonEngine = null;
        let intelligentChatbot = null;
        let analyticsEngine = null;
        let currentSessionId = null;

        // Initialize AI components when available
        function initializeAIComponents() {
            // Initialize AI components with detailed error checking
            setTimeout(() => {
                try {
                    console.log('Checking AI component availability...');
                    
                    if (typeof AICarbonEngine !== 'undefined') {
                        console.log('✓ AICarbonEngine available');
                        aiCarbonEngine = new AICarbonEngine();
                    } else {
                        console.warn('✗ AICarbonEngine not found');
                        aiCarbonEngine = new BasicCarbonCalculator();
                    }
                    
                    if (typeof IntelligentChatbot !== 'undefined') {
                        console.log('✓ IntelligentChatbot available');
                        intelligentChatbot = new IntelligentChatbot();
                        console.log('✓ IntelligentChatbot initialized successfully');
                    } else {
                        console.warn('✗ IntelligentChatbot not found');
                        intelligentChatbot = new BasicChatbot();
                    }
                    
                    if (typeof CarbonAnalyticsEngine !== 'undefined') {
                        console.log('✓ CarbonAnalyticsEngine available');
                        analyticsEngine = new CarbonAnalyticsEngine();
                    } else {
                        console.warn('✗ CarbonAnalyticsEngine not found');
                    }
                    
                    currentSessionId = generateSessionId();
                    console.log('✓ AI initialization complete');
                    
                } catch (error) {
                    console.error('AI component initialization error:', error);
                    console.log('Using fallback implementations');
                    aiCarbonEngine = new BasicCarbonCalculator();
                    intelligentChatbot = new BasicChatbot();
                }
            }, 100); // Small delay to ensure scripts are loaded
        }

        // --- Enhanced Calculation Function ---
        async function handleAdvancedCalculation() {
            const form = document.getElementById('carbonCalcForm');
            const resultsContainer = document.getElementById('resultsContainer');
            
            // Show loading state
            form.classList.add('loading');
            
            try {
                // Collect all form data
                const formData = new FormData(form);
                const inputs = {
                    energy: Number(formData.get('energy')),
                    fuel: Number(formData.get('fuel')),
                    employees: Number(formData.get('employees')),
                    travel: Number(formData.get('travel')),
                    waste: Number(formData.get('waste'))
                };
                
                const context = {
                    energySource: formData.get('energySource'),
                    fuelType: formData.get('fuelType'),
                    industry: formData.get('industry'),
                    location: formData.get('location'),
                    companySize: formData.get('companySize'),
                    hasGreenInitiatives: formData.get('greenInitiatives') === 'on',
                    remoteWorkPercentage: Number(formData.get('remoteWork'))
                };
                
                // Debug: Log form data
                console.log('Form inputs:', inputs);
                console.log('Form context:', context);
                
                // Validate inputs
                if (!validateInputs(inputs)) {
                    console.error('Validation failed for inputs:', inputs);
                    const missingFields = Object.entries(inputs).filter(([key, value]) => isNaN(value) || value < 0);
                    throw new Error(`Invalid input data. Missing or invalid fields: ${missingFields.map(([key]) => key).join(', ')}`);
                }
                
                // Calculate using AI engine
                let results;
                if (aiCarbonEngine && aiCarbonEngine.calculateAdvancedFootprint) {
                    results = aiCarbonEngine.calculateAdvancedFootprint(inputs, context);
                } else {
                    results = calculateBasicFootprint(inputs, context);
                }
                
                // Display results
                displayResults(results, null, context);
                
                // Save calculation history
                saveCalculationHistory(inputs, context, results);
                
            } catch (error) {
                console.error('Calculation error:', error);
                showErrorMessage('Unable to complete calculation. Please check your inputs and try again.');
            } finally {
                form.classList.remove('loading');
            }
        }

        // --- Display Results Function ---
        function displayResults(results, analytics, context) {
            const resultsContainer = document.getElementById('resultsContainer');
            
            // Update key metrics
            document.getElementById('totalEmissions').textContent = results.total_emissions.toFixed(2);
            document.getElementById('perEmployeeEmissions').textContent = (results.total_emissions / (results.detailed_emissions?.employees || 1)).toFixed(2);
            document.getElementById('confidenceScore').textContent = Math.round((results.confidence_score || 0.75) * 100) + '%';
            
            if (results.industry_benchmark) {
                document.getElementById('industryPercentile').textContent = results.industry_benchmark.percentile + 'th';
            } else {
                document.getElementById('industryPercentile').textContent = '75th';
            }
            
            // Update efficiency score
            document.getElementById('efficiencyScore').textContent = '75/100';
            
            // Create visualizations
            createBreakdownChart(results.detailed_emissions);
            createBenchmarkChart(results, context);
            
            // Display recommendations
            displayRecommendations(results.recommendations);
            
            // Display predictions
            if (results.predictions) {
                displayPredictions(results.predictions);
            }
            
            // Show results container
            resultsContainer.style.display = 'block';
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
        }

        // --- Chart Storage ---
        let breakdownChart = null;
        let benchmarkChart = null;

        // --- Chart Creation Functions ---
        function createBreakdownChart(emissions) {
            const ctx = document.getElementById('breakdownChart');
            if (!ctx) return;
            
            // Destroy existing chart if it exists
            if (breakdownChart) {
                breakdownChart.destroy();
                breakdownChart = null;
            }
            
            breakdownChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Energy', 'Fuel', 'Employees', 'Travel', 'Waste'],
                    datasets: [{
                        data: [
                            emissions?.energy || 0,
                            emissions?.fuel || 0,
                            emissions?.employees || 0,
                            emissions?.travel || 0,
                            emissions?.waste || 0
                        ],
                        backgroundColor: ['#00b894', '#00897b', '#26a69a', '#4db6ac', '#80cbc4']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Emission Sources Breakdown'
                        }
                    }
                }
            });
        }

        function createBenchmarkChart(results, context) {
            const ctx = document.getElementById('benchmarkChart');
            if (!ctx) return;
            
            // Destroy existing chart if it exists
            if (benchmarkChart) {
                benchmarkChart.destroy();
                benchmarkChart = null;
            }
            
            const emissionsPerEmployee = results.total_emissions / (results.detailed_emissions?.employees || 1);
            
            benchmarkChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Your Company', 'Industry Average', 'Best in Class'],
                    datasets: [{
                        label: 'Emissions per Employee (tons CO₂e)',
                        data: [emissionsPerEmployee, emissionsPerEmployee * 1.3, emissionsPerEmployee * 0.6],
                        backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Industry Benchmark Comparison'
                        }
                    }
                }
            });
        }

        // --- Recommendations Display ---
        function displayRecommendations(recommendations) {
            const container = document.getElementById('aiRecommendations');
            if (!container || !recommendations) return;
            
            container.innerHTML = '';
            
            recommendations.forEach((rec, index) => {
                const recElement = document.createElement('div');
                recElement.className = 'recommendation-item';
                recElement.innerHTML = `
                    <div class="recommendation-priority priority-medium">
                        HIGH IMPACT
                    </div>
                    <div class="recommendation-text">${rec}</div>
                `;
                container.appendChild(recElement);
            });
        }

        // --- Predictions Display ---
        function displayPredictions(predictions) {
            if (predictions.next_year_projection) {
                document.getElementById('nextYearProjection').textContent = 
                    predictions.next_year_projection.toFixed(1) + ' tons CO₂e';
            }
            if (predictions.reduction_potential) {
                document.getElementById('reductionPotential').textContent = 
                    predictions.reduction_potential.toFixed(1) + ' tons CO₂e';
            }
            if (predictions.carbon_neutrality_timeline) {
                document.getElementById('neutralityTimeline').textContent = 
                    predictions.carbon_neutrality_timeline.estimated_years + ' years';
            }
            if (predictions.cost_savings_estimate) {
                document.getElementById('costSavings').textContent = 
                    '$' + Math.round(predictions.cost_savings_estimate.annual_savings / 1000) + 'K/year';
            }
        }

        // --- Utility Functions ---
        function validateInputs(inputs) {
            return Object.values(inputs).every(val => !isNaN(val) && val >= 0);
        }

        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function saveCalculationHistory(inputs, context, results) {
            const history = JSON.parse(localStorage.getItem('calculationHistory') || '[]');
            history.push({
                timestamp: new Date().toISOString(),
                inputs,
                context,
                results: {
                    total_emissions: results.total_emissions,
                    confidence_score: results.confidence_score
                }
            });
            
            if (history.length > 10) {
                history.splice(0, history.length - 10);
            }
            
            localStorage.setItem('calculationHistory', JSON.stringify(history));
        }

        function showErrorMessage(message) {
            const msgDiv = document.createElement('div');
            msgDiv.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 9999;
                background: #ff6b6b; color: white; padding: 1rem 1.5rem;
                border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            `;
            msgDiv.textContent = message;
            document.body.appendChild(msgDiv);
            
            setTimeout(() => document.body.removeChild(msgDiv), 5000);
        }

        // --- Fallback Calculator ---
        class BasicCarbonCalculator {
            calculateAdvancedFootprint(inputs, context) {
                const { energy, fuel, employees, travel, waste } = inputs;
                
                let energyEmissions = energy * 0.233;
                let fuelEmissions = fuel * 2.68;
                let employeeEmissions = employees * 1500;
                let travelEmissions = travel * 0.18;
                let wasteEmissions = waste * 1900;
                
                if (context.hasGreenInitiatives) {
                    energyEmissions *= 0.85;
                    fuelEmissions *= 0.9;
                }
                
                if (context.remoteWorkPercentage > 0) {
                    employeeEmissions *= (1 - context.remoteWorkPercentage / 100 * 0.3);
                }
                
                const totalKgCO2e = energyEmissions + fuelEmissions + employeeEmissions + travelEmissions + wasteEmissions;
                const totalTons = totalKgCO2e / 1000;
                
                return {
                    total_emissions: totalTons,
                    detailed_emissions: {
                        energy: energyEmissions / 1000,
                        fuel: fuelEmissions / 1000,
                        employees: employeeEmissions / 1000,
                        travel: travelEmissions / 1000,
                        waste: wasteEmissions / 1000
                    },
                    confidence_score: 0.75,
                    recommendations: this.getBasicRecommendations(totalTons),
                    predictions: {
                        next_year_projection: totalTons * 1.02,
                        reduction_potential: totalTons * 0.3,
                        carbon_neutrality_timeline: { estimated_years: 8 },
                        cost_savings_estimate: { annual_savings: totalTons * 125 }
                    }
                };
            }
            
            getBasicRecommendations(totalTons) {
                if (totalTons < 50) return ["🌱 Your company has a relatively low footprint. Focus on maintaining efficiency and exploring renewable energy."];
                if (totalTons < 150) return ["⚡ Consider energy efficiency improvements and remote work policies to reduce emissions."];
                if (totalTons < 500) return ["🔄 Implement comprehensive sustainability programs including renewable energy and waste reduction."];
                return ["🎯 Significant emissions detected. Develop a comprehensive decarbonization strategy with professional guidance."];
            }
        }

        class BasicChatbot {
            async processMessage(message, sessionId) {
                const cleaned = message.toLowerCase();
                
                if (cleaned.includes("hello") || cleaned.includes("hi")) {
                    return { response: "Hello! 👋 I'm your EcoLeaf AI Assistant. How can I help with your sustainability journey?" };
                }
                if (cleaned.includes("calculate") || cleaned.includes("footprint")) {
                    return { response: "You can use our AI-Powered Carbon Calculator above to get detailed emissions analysis with machine learning insights!" };
                }
                if (cleaned.includes("reduce") || cleaned.includes("strategy")) {
                    return { response: "Our platform provides personalized reduction strategies based on your specific emissions profile and industry benchmarks." };
                }
                
                return { response: "I'm here to help with carbon accounting and sustainability questions. Try asking about calculations, reduction strategies, or industry best practices!" };
            }
        }

        function calculateBasicFootprint(inputs, context) {
            const calculator = new BasicCarbonCalculator();
            return calculator.calculateAdvancedFootprint(inputs, context);
        }

        // Enhanced chatbot response processing
        async function processBotResponse(msg) {
            if (intelligentChatbot) {
                try {
                    const response = await intelligentChatbot.processMessage(msg, currentSessionId);
                    return response.response;
                } catch (error) {
                    console.error('Chatbot error:', error);
                    return getFallbackResponse(msg);
                }
            } else {
                return getFallbackResponse(msg);
            }
        }
        
        function getFallbackResponse(msg) {
            const cleaned = msg.toLowerCase();
            if (cleaned.includes("hello") || cleaned.includes("hi")) return "Hello! 👋 I'm your EcoLeaf AI Assistant powered by advanced machine learning. How can I help with your sustainability journey?";
            if (cleaned.includes("calculate") || cleaned.includes("footprint")) return "You can try our AI-Powered Carbon Calculator above! It uses machine learning algorithms for accurate calculations and industry-specific insights.";
            if (cleaned.includes("demo") || cleaned.includes("contact")) return "To request a demo, just click the 'Request a Demo' button at the top right. We'll get in touch quickly!";
            if (cleaned.includes("reduce") || cleaned.includes("strategy")) return "Great question! Our AI analyzes your data to provide personalized reduction strategies based on machine learning models and industry benchmarks.";
            if (cleaned.includes("ai") || cleaned.includes("machine learning")) return "Our platform uses advanced AI including natural language processing, predictive analytics, and machine learning models to provide intelligent carbon accounting insights.";
            if (cleaned.includes("thank")) return "You're welcome! 😊";
            if (cleaned.includes("bye")) return "Goodbye! If you have more questions about AI-powered carbon accounting, just ask.";
            return "I'm here to help with carbon accounting, sustainability, and AI-powered insights. Try asking about our calculator, reduction strategies, or machine learning capabilities!";
        }

        // --- UI Initialization Functions ---
        function initializeUI() {
            // Range slider interactivity
            const remoteWorkSlider = document.getElementById('remoteWork');
            const remoteWorkValue = document.querySelector('.range-value');
            
            if (remoteWorkSlider && remoteWorkValue) {
                remoteWorkSlider.addEventListener('input', function() {
                    remoteWorkValue.textContent = this.value + '%';
                });
            }

            // Save/Load data functionality
            const saveBtn = document.getElementById('saveDataBtn');
            if (saveBtn) {
                saveBtn.addEventListener('click', function() {
                    saveFormData();
                    showSuccessMessage('Data saved successfully!');
                });
            }

            const loadBtn = document.getElementById('loadDataBtn');
            if (loadBtn) {
                loadBtn.addEventListener('click', function() {
                    loadSavedDataManually();
                });
            }

            const clearBtn = document.getElementById('clearDataBtn');
            if (clearBtn) {
                clearBtn.addEventListener('click', function() {
                    if (confirm('Are you sure you want to clear all form data? This action cannot be undone.')) {
                        clearFormData();
                    }
                });
            }
            
            // Don't auto-load saved data on page load anymore
            // loadSavedData();

            // Form validation
            const inputs = document.querySelectorAll('#carbonCalcForm input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('blur', function() {
                    validateSingleInput(this);
                });
            });
        }

        function saveFormData() {
            const form = document.getElementById('carbonCalcForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            localStorage.setItem('ecoLeafFormData', JSON.stringify(data));
        }

        function loadSavedData() {
            // Only load saved data if user wants to (not on fresh page load)
            const urlParams = new URLSearchParams(window.location.search);
            const loadSaved = urlParams.get('loadSaved') === 'true';
            
            if (!loadSaved) return; // Don't auto-load on fresh visits
            
            const savedData = localStorage.getItem('ecoLeafFormData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    Object.entries(data).forEach(([key, value]) => {
                        const element = document.getElementById(key);
                        if (element) {
                            element.value = value;
                            if (element.type === 'checkbox') {
                                element.checked = value === 'on';
                            }
                        }
                    });
                } catch (error) {
                    console.error('Error loading saved data:', error);
                }
            }
        }

        function clearFormData() {
            // Clear localStorage
            localStorage.removeItem('ecoLeafFormData');
            
            // Clear all form fields
            const form = document.getElementById('carbonCalcForm');
            if (form) {
                form.reset();
                
                // Reset any custom styling
                const inputs = form.querySelectorAll('input, select');
                inputs.forEach(input => {
                    input.style.borderColor = '';
                    if (input.type === 'number') {
                        input.value = '';
                    }
                });
                
                // Clear results
                const resultsContainer = document.getElementById('resultsContainer');
                if (resultsContainer) {
                    resultsContainer.style.display = 'none';
                }
                
                showSuccessMessage('Form cleared successfully! 🧹');
            }
        }

        function loadSavedDataManually() {
            const savedData = localStorage.getItem('ecoLeafFormData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    Object.entries(data).forEach(([key, value]) => {
                        const element = document.getElementById(key);
                        if (element) {
                            element.value = value;
                            if (element.type === 'checkbox') {
                                element.checked = value === 'on';
                            }
                        }
                    });
                    showSuccessMessage('Saved data loaded! 📋');
                } catch (e) {
                    console.error('Error loading saved data:', e);
                }
            } else {
                showSuccessMessage('No saved data found 📭');
            }
        }

        function validateSingleInput(input) {
            const value = Number(input.value);
            if (isNaN(value) || value < 0) {
                input.style.borderColor = '#ff6b6b';
                return false;
            } else {
                input.style.borderColor = '#c7f0d2';
                return true;
            }
        }

        function showSuccessMessage(message) {
            const msgDiv = document.createElement('div');
            msgDiv.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 9999;
                background: var(--primary); color: white; padding: 1rem 1.5rem;
                border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                animation: slideIn 0.3s ease-out;
            `;
            msgDiv.textContent = message;
            document.body.appendChild(msgDiv);
            
            setTimeout(() => {
                msgDiv.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => document.body.removeChild(msgDiv), 300);
            }, 3000);
        }
        // --- Modal "Request a Demo" ---
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize AI components
            initializeAIComponents();
            
            // Initialize UI components
            initializeUI();

            const modalOverlay = document.getElementById('modalOverlay');
            const requestDemoBtn = document.getElementById('requestDemoBtn');
            const modalCloseBtn = document.getElementById('modalCloseBtn');
            const modalDemoForm = document.getElementById('modalDemoForm');
            const modalSuccessMsg = document.getElementById('modalSuccessMsg');
            let lastFocus = null;
            function openDemoModal(e) {
                if(e) e.preventDefault();
                modalOverlay.classList.add('active');
                lastFocus = document.activeElement;
                setTimeout(() => {
                    document.getElementById('demoName').focus();
                }, 120);
                document.body.style.overflow = 'hidden';
            }
            function closeDemoModal() {
                modalOverlay.classList.remove('active');
                modalDemoForm.reset();
                modalSuccessMsg.classList.remove('active');
                if(lastFocus) lastFocus.focus();
                document.body.style.overflow = '';
            }
            function handleDemoSubmit(e){
                e.preventDefault();
                modalSuccessMsg.classList.add('active');
                setTimeout(closeDemoModal, 1700);
            }
            requestDemoBtn.addEventListener('click', openDemoModal);
            modalCloseBtn.addEventListener('click', closeDemoModal);
            modalDemoForm.addEventListener('submit', handleDemoSubmit);
            modalOverlay.addEventListener('mousedown', function(e){
                if(e.target === modalOverlay){ closeDemoModal(); }
            });
            window.addEventListener('keydown', function(e){
                if(modalOverlay.classList.contains('active') && e.key === 'Escape'){ closeDemoModal(); }
            });
            modalOverlay.addEventListener('keydown', function(e){
                if(e.key !== 'Tab') return;
                const focusables = modalOverlay.querySelectorAll('input, textarea, button:not([disabled])');
                if(!focusables.length) return;
                const first = focusables[0], last = focusables[focusables.length-1];
                if(!e.shiftKey && document.activeElement === last){
                    first.focus();
                    e.preventDefault();
                }
                if(e.shiftKey && document.activeElement === first){
                    last.focus();
                    e.preventDefault();
                }
            });
            // --- Scroll Reveal Animation ---
            const revealElements = document.querySelectorAll('.reveal');
            const revealOnScroll = () => {
                const windowHeight = window.innerHeight;
                revealElements.forEach(el => {
                    const elementTop = el.getBoundingClientRect().top;
                    if (elementTop < windowHeight - 100) {
                        el.classList.add('visible');
                    }
                });
            };
            window.addEventListener('scroll', revealOnScroll);
            revealOnScroll();
            // --- Animated Counter ---
            const counters = document.querySelectorAll('.stat-number');
            const speed = 200;
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const counter = entry.target;
                        const updateCount = () => {
                            const target = +counter.getAttribute('data-target');
                            const count = +counter.innerText;
                            const inc = Math.ceil(target / speed);
                            if (count < target) {
                                counter.innerText = Math.min(count + inc, target);
                                setTimeout(updateCount, 10);
                            } else {
                                counter.innerText = target;
                            }
                        };
                        updateCount();
                        observer.unobserve(counter);
                    }
                });
            }, { threshold: 0.5 });
            counters.forEach(counter => observer.observe(counter));
            // --- FAQ Accordion ---
            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                const button = item.querySelector('.faq-question');
                button.addEventListener('click', () => {
                    const wasActive = item.classList.contains('active');
                    faqItems.forEach(i => i.classList.remove('active'));
                    if (!wasActive) {
                        item.classList.add('active');
                    }
                });
            });
            // --- Enhanced Carbon Calculator Logic ---
            const form = document.getElementById('carbonCalcForm');
            const resultsContainer = document.getElementById('resultsContainer');
            
            form.addEventListener('submit', async function(event) {
                event.preventDefault();
                await handleAdvancedCalculation();
            });

            // --- EcoLeaf AI Chatbot ---
            const ecoWidget = document.getElementById('ecoChatbot-widget');
            const ecoToggle = document.getElementById('ecoChatbot-toggle');
            const ecoBody = document.getElementById('ecoChatbot-body');
            const ecoClose = document.getElementById('ecoChatbot-close');
            const ecoForm = document.getElementById('ecoChatbot-inputbar');
            const ecoInput = document.getElementById('ecoChatbot-input');
            const ecoSend = document.getElementById('ecoChatbot-send');
            const ecoMsgs = document.getElementById('ecoChatbot-messages');

            let botBusy = false, msgTimer = null;

            function sendBotMessage(txt, delay=800) {
                botBusy = true;
                const typingDiv = document.createElement('div');
                typingDiv.className = 'ecoChatbot-msg bot';
                typingDiv.innerHTML = '<div class="bubble"><span class="typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span></div>';
                ecoMsgs.appendChild(typingDiv);
                ecoMsgs.scrollTop = ecoMsgs.scrollHeight;
                msgTimer = setTimeout(()=>{
                    typingDiv.innerHTML = `<div class="bubble">${txt}</div>`;
                    botBusy = false;
                    ecoMsgs.scrollTop = ecoMsgs.scrollHeight;
                }, delay);
            }
            
            function sendUserMessage(txt) {
                const userDiv = document.createElement('div');
                userDiv.className = 'ecoChatbot-msg user';
                userDiv.innerHTML = `<div class="bubble">${txt}</div>`;
                ecoMsgs.appendChild(userDiv);
                ecoMsgs.scrollTop = ecoMsgs.scrollHeight;
            }
            
            function openChatbot() {
                ecoWidget.classList.add('open');
                ecoBody.setAttribute('aria-hidden','false');
                setTimeout(()=>ecoInput.focus(), 150);
                if (ecoMsgs.childElementCount===0) {
                    sendBotMessage("Hello 👋<br>I'm your AI assistant powered by advanced natural language processing and machine learning. How can I help with your carbon accounting goals?");
                }
            }
            const qaPairs = [
              {
                keywords: ['hello', 'hi', 'hey'],
                response: "Hello! 👋 I'm your EcoLeaf AI Assistant. How can I help with your sustainability journey today?"
              },
              {
                keywords: ['carbon calculator', 'footprint', 'calculate', 'estimate'],
                response: "You can try our Carbon Footprint Calculator above on this page! Enter your company data and I'll give you both a value and AI-powered advice."
              },
              {
                keywords: ['contact', 'demo', 'trial'],
                response: "To request a demo, just click the 'Request a Demo' button at the top right. We'll get in touch quickly!"
              },
              {
                keywords: ['reduce', 'strategy', 'emission', 'plan'],
                response: "Great question! Start by improving energy efficiency, switching to renewables, reducing travel, and minimizing waste. Need tailored tips for your company? Try our calculator above and I’ll give targeted advice."
              },
              {
                keywords: ['ai', 'ml', 'machine learning', 'intelligent'],
                response: "Our platform uses machine learning and AI to simplify tracking and reporting, and to offer actionable sustainability recommendations. Ask me any technical question!"
              },
              {
                keywords: ['faq', 'support', 'help', 'how'],
                response: "You can scroll to the FAQ section on this page for common questions, or just type your question here."
              },
              {
                keywords: ['ghg protocol', 'iso', 'standard', 'compliance'],
                response: "EcoLeaf Analytics is fully compliant with GHG Protocol, ISO 14064 and other major sustainability reporting standards."
              }
            ];
            function sendBotMessage(txt, delay=800) {
                botBusy = true;
                const typingDiv = document.createElement('div');
                typingDiv.className = 'ecoChatbot-msg bot';
                typingDiv.innerHTML = '<div class="bubble"><span class="typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span></div>';
                ecoMsgs.appendChild(typingDiv);
                ecoMsgs.scrollTop = ecoMsgs.scrollHeight;
                msgTimer = setTimeout(()=>{
                    typingDiv.innerHTML = `<div class="bubble">${txt}</div>`;
                    botBusy = false;
                    ecoMsgs.scrollTop = ecoMsgs.scrollHeight;
                }, delay);
            }
            function sendUserMessage(txt) {
                const userDiv = document.createElement('div');
                userDiv.className = 'ecoChatbot-msg user';
                userDiv.innerHTML = `<div class="bubble">${txt}</div>`;
                ecoMsgs.appendChild(userDiv);
                ecoMsgs.scrollTop = ecoMsgs.scrollHeight;
            }
            async function processBotResponse(msg) {
                if (typeof intelligentChatbot !== 'undefined' && intelligentChatbot.processMessage) {
                    try {
                        const response = await intelligentChatbot.processMessage(msg, currentSessionId);
                        return response.response || response.message;
                    } catch (error) {
                        console.error('AI Chatbot error:', error);
                        return getFallbackResponse(msg);
                    }
                } else {
                    return getFallbackResponse(msg);
                }
            }
            
            function getFallbackResponse(msg) {
                const cleaned = msg.toLowerCase();
                
                // AI and ML related responses
                if (cleaned.includes('ai') || cleaned.includes('artificial intelligence')) {
                    return "Our AI engine uses machine learning algorithms to provide more accurate carbon calculations based on industry benchmarks and historical data patterns.";
                }
                if (cleaned.includes('machine learning') || cleaned.includes('ml')) {
                    return "Our machine learning models analyze thousands of data points to predict emission factors and provide intelligent recommendations for reducing your carbon footprint.";
                }
                if (cleaned.includes('algorithm') || cleaned.includes('prediction')) {
                    return "We use advanced predictive algorithms that learn from your usage patterns and industry trends to offer personalized carbon reduction strategies.";
                }
                
                // Traditional Q&A fallback
                for (let i=0; i<qaPairs.length; i++) {
                    if (qaPairs[i].keywords.some(k=>cleaned.includes(k))) {
                        return qaPairs[i].response;
                    }
                }
                
                // Enhanced default responses
                if (cleaned.includes("thank")) return "You're welcome! Our AI is always learning to serve you better 😊";
                if (cleaned.includes("bye")) return "Goodbye! Feel free to return anytime for AI-powered carbon insights.";
                
                return "I'm your AI-powered assistant specializing in carbon accounting and sustainability insights. Ask me about our ML algorithms, emission calculations, or green practices!";
            }
            function openChatbot() {
                ecoWidget.classList.add('open');
                ecoBody.setAttribute('aria-hidden','false');
                setTimeout(()=>ecoInput.focus(), 150);
                if (ecoMsgs.childElementCount===0) {
                    sendBotMessage("Hello 👋<br>How can I help you with your sustainability or carbon accounting goals?");
                }
            }
            function closeChatbot() {
                ecoWidget.classList.remove('open');
                ecoBody.setAttribute('aria-hidden','true');
                clearTimeout(msgTimer);
            }
            ecoToggle.addEventListener('click', ()=>{
                if(ecoWidget.classList.contains('open')) closeChatbot(); else openChatbot();
            });
            ecoClose.addEventListener('click', closeChatbot);
            ecoForm.addEventListener('submit', async function(e){
                e.preventDefault();
                if(botBusy) return;
                let value = ecoInput.value.trim();
                if(!value) return;
                sendUserMessage(value);
                ecoInput.value='';
                const response = await processBotResponse(value);
                sendBotMessage(response);
            });
            ecoInput.addEventListener('keydown', function(e){
                if(e.key==='Enter' && !e.shiftKey){e.preventDefault(); ecoForm.requestSubmit();}
            });
        });
    </script>
</body>
</html>
